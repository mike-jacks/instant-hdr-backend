basePath: /api/v1
definitions:
  instant-hdr-backend_internal_models.BracketResponse:
    properties:
      bracket_id:
        type: string
      created_at:
        type: string
      filename:
        type: string
      id:
        type: string
      image_id:
        type: string
      is_uploaded:
        type: boolean
      metadata:
        additionalProperties: true
        type: object
    type: object
  instant-hdr-backend_internal_models.BracketsResponse:
    properties:
      brackets:
        items:
          $ref: '#/definitions/instant-hdr-backend_internal_models.BracketResponse'
        type: array
    type: object
  instant-hdr-backend_internal_models.CreateOrderRequest:
    properties:
      metadata:
        additionalProperties: true
        description: Optional metadata to store with order
        type: object
    type: object
  instant-hdr-backend_internal_models.DownloadImageRequest:
    properties:
      format:
        description: |-
          Format - Image format: "jpeg" (default), "png", or "webp"
          Example: "jpeg"
        example: jpeg
        type: string
      max_width:
        description: |-
          MaxWidth - Custom width in pixels (only used when quality="custom")
          Example: 2400
        example: 2400
        type: integer
      quality:
        description: |-
          Quality preset - Options: "thumbnail" (400px), "preview" (800px), "medium" (1920px), "high" (full res), or "custom"
          Default: "preview"
          Example: "high"
        example: high
        type: string
      scale:
        description: |-
          Scale - Scale factor (only used when quality="custom")
          Example: 0.5 for 50% of original size
        example: 0.5
        type: number
      watermark:
        description: |-
          Watermark - Whether to include watermark. Defaults to true (FREE). Set to false to use 1 credit (unwatermarked)
          Example: true
        example: true
        type: boolean
    type: object
  instant-hdr-backend_internal_models.DownloadImageResponse:
    properties:
      credit_used:
        description: CreditUsed indicates if this download cost a credit
        example: false
        type: boolean
      file_size:
        description: FileSize in bytes
        example: 2621440
        type: integer
      format:
        description: Format of the downloaded image
        example: jpeg
        type: string
      image_id:
        description: ImageID from AutoEnhance
        example: img_abc123
        type: string
      message:
        description: Message with download details
        example: 'Image downloaded successfully (FREE with watermark) - Quality: high,
          Resolution: full'
        type: string
      quality:
        description: Quality preset used
        example: high
        type: string
      resolution:
        description: Resolution achieved (e.g., "400px", "800px", "1920px", "full")
        example: full
        type: string
      url:
        description: URL to access the image in Supabase Storage (publicly accessible)
        example: https://project.supabase.co/storage/v1/object/public/hdr-images/users/user123/orders/order456/img_abc123_high.jpg
        type: string
      watermark:
        description: Watermark indicates if watermark was applied (true = FREE, false
          = COSTS 1 CREDIT)
        example: true
        type: boolean
    type: object
  instant-hdr-backend_internal_models.ErrorResponse:
    properties:
      error:
        type: string
      message:
        type: string
    type: object
  instant-hdr-backend_internal_models.FileInfo:
    properties:
      filename:
        type: string
      size:
        type: integer
    type: object
  instant-hdr-backend_internal_models.FileResponse:
    properties:
      created_at:
        type: string
      file_size:
        type: integer
      filename:
        type: string
      id:
        type: string
      is_final:
        type: boolean
      mime_type:
        type: string
      storage_url:
        type: string
    type: object
  instant-hdr-backend_internal_models.FilesResponse:
    properties:
      files:
        items:
          $ref: '#/definitions/instant-hdr-backend_internal_models.FileResponse'
        type: array
    type: object
  instant-hdr-backend_internal_models.HealthResponse:
    properties:
      status:
        type: string
    type: object
  instant-hdr-backend_internal_models.ImageResponse:
    properties:
      downloaded:
        type: boolean
      enhance_type:
        type: string
      high_res_downloaded:
        type: boolean
      high_res_url:
        description: Supabase URL for high-res
        type: string
      image_id:
        type: string
      image_name:
        type: string
      preview_downloaded:
        type: boolean
      preview_url:
        description: Supabase URL for preview
        type: string
      processing_settings:
        additionalProperties: true
        type: object
      status:
        type: string
    type: object
  instant-hdr-backend_internal_models.ImagesResponse:
    properties:
      images:
        items:
          $ref: '#/definitions/instant-hdr-backend_internal_models.ImageResponse'
        type: array
    type: object
  instant-hdr-backend_internal_models.OrderListResponse:
    properties:
      orders:
        items:
          $ref: '#/definitions/instant-hdr-backend_internal_models.OrderSummary'
        type: array
    type: object
  instant-hdr-backend_internal_models.OrderResponse:
    properties:
      autoenhance_status:
        description: AutoEnhance data (when available)
        type: string
      created_at:
        type: string
      error_message:
        type: string
      images:
        items:
          additionalProperties: true
          type: object
        type: array
      is_processing:
        type: boolean
      metadata:
        additionalProperties: true
        type: object
      order_id:
        type: string
      progress:
        type: integer
      status:
        type: string
      total_brackets:
        type: integer
      total_images:
        type: integer
      updated_at:
        type: string
      uploaded_brackets:
        type: integer
    type: object
  instant-hdr-backend_internal_models.OrderSummary:
    properties:
      created_at:
        type: string
      order_id:
        type: string
      progress:
        type: integer
      status:
        type: string
      updated_at:
        type: string
    type: object
  instant-hdr-backend_internal_models.ProcessRequest:
    properties:
      enhance_type:
        description: |-
          EnhanceType specifies the type of enhancement to apply
          Options: "property", "property_usa", "warm", "neutral", "modern"
          Default: "property" for real estate photography
        example: property
        type: string
      lens_correction:
        example: true
        type: boolean
      metadata:
        additionalProperties: true
        description: Optional metadata to store with the processing request
        type: object
      privacy:
        example: false
        type: boolean
      sky_replacement:
        example: true
        type: boolean
      upscale:
        example: false
        type: boolean
      vertical_correction:
        example: true
        type: boolean
      window_pull_type:
        description: '"NONE", "ONLY_WINDOWS", "WINDOWS_WITH_SKIES"'
        example: ONLY_WINDOWS
        type: string
    type: object
  instant-hdr-backend_internal_models.ProcessResponse:
    properties:
      message:
        type: string
      order_id:
        type: string
      processing_params:
        additionalProperties: true
        type: object
      status:
        type: string
    type: object
  instant-hdr-backend_internal_models.StatusResponse:
    properties:
      autoenhance_status:
        description: AutoEnhance data
        type: string
      images:
        items:
          additionalProperties: true
          type: object
        type: array
      is_processing:
        type: boolean
      order_id:
        type: string
      progress:
        type: integer
      status:
        type: string
      total_brackets:
        type: integer
      total_images:
        type: integer
      updated_at:
        type: string
      uploaded_brackets:
        type: integer
    type: object
  instant-hdr-backend_internal_models.UploadErrorInfo:
    properties:
      error:
        type: string
      filename:
        type: string
      stage:
        description: '"create_bracket", "upload", "verify", "database"'
        type: string
    type: object
  instant-hdr-backend_internal_models.UploadResponse:
    properties:
      errors:
        items:
          $ref: '#/definitions/instant-hdr-backend_internal_models.UploadErrorInfo'
        type: array
      files:
        items:
          $ref: '#/definitions/instant-hdr-backend_internal_models.FileInfo'
        type: array
      order_id:
        type: string
      status:
        type: string
    type: object
host: localhost:8080
info:
  contact:
    email: support@example.com
    name: API Support
  description: Backend API for processing bracketed images with AutoEnhance AI HDR
    merging. This API handles order creation, image uploads, HDR processing, and real-time
    status updates via Supabase Realtime.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: Instant HDR Backend API
  version: 1.0.0
paths:
  /health:
    get:
      consumes:
      - application/json
      description: Returns the health status of the API
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.HealthResponse'
      summary: Health check
      tags:
      - health
  /orders:
    get:
      consumes:
      - application/json
      description: Returns a list of all orders for the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.OrderListResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: List all orders
      tags:
      - orders
    post:
      consumes:
      - application/json
      description: Creates a new AutoEnhance AI order for a listing (real estate shoot).
        Returns the order ID and AutoEnhance order ID.
      parameters:
      - description: Order metadata (optional)
        in: body
        name: request
        schema:
          $ref: '#/definitions/instant-hdr-backend_internal_models.CreateOrderRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.OrderResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Create a new order
      tags:
      - orders
  /orders/{order_id}:
    delete:
      consumes:
      - application/json
      description: Deletes an order, including associated AutoEnhance AI order and
        files from Supabase Storage
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: message
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Delete an order
      tags:
      - orders
    get:
      consumes:
      - application/json
      description: Returns detailed information about a specific order
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.OrderResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Get order details
      tags:
      - orders
  /orders/{order_id}/brackets:
    get:
      consumes:
      - application/json
      description: Returns a list of all uploaded brackets (raw images) for an order
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.BracketsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Get uploaded brackets
      tags:
      - brackets
  /orders/{order_id}/files:
    get:
      consumes:
      - application/json
      description: Returns a list of all processed files associated with an order,
        including their Supabase Storage URLs
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.FilesResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Get order files
      tags:
      - files
  /orders/{order_id}/images:
    get:
      consumes:
      - application/json
      description: Returns a list of all processed images for an order with their
        download status
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ImagesResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: List processed images
      tags:
      - images
  /orders/{order_id}/images/{image_id}/download:
    post:
      consumes:
      - application/json
      description: |-
        Downloads a processed image from AutoEnhance and stores it in Supabase Storage.

        Quality Options:
        - "thumbnail": 400px width (~50-100KB) - List view
        - "preview": 800px width (~150-250KB) - Gallery view (DEFAULT)
        - "medium": 1920px width (~500KB-1MB) - Full screen
        - "high": Full resolution (~2-5MB) - Client delivery
        - "custom": Specify max_width or scale

        Format Options: "jpeg" (default), "png", "webp"

        Watermark (defaults to true = FREE):
        - true: FREE download with watermark
        - false: COSTS 1 CREDIT (unwatermarked)
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      - description: Image ID from AutoEnhance
        in: path
        name: image_id
        required: true
        type: string
      - description: Download options
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/instant-hdr-backend_internal_models.DownloadImageRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.DownloadImageResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Download processed image to Supabase Storage
      tags:
      - images
  /orders/{order_id}/process:
    post:
      consumes:
      - application/json
      description: Initiates HDR processing and merging of uploaded images using AutoEnhance
        AI. Groups brackets into images and processes them with the specified enhancement
        options.
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      - description: Processing options. enhance_type defaults to 'property' for real
          estate photography.
        in: body
        name: request
        schema:
          $ref: '#/definitions/instant-hdr-backend_internal_models.ProcessRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ProcessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Process images with HDR merge
      tags:
      - process
  /orders/{order_id}/status:
    get:
      consumes:
      - application/json
      description: Returns the current status and progress of an order. For real-time
        updates, connect to Supabase Realtime.
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.StatusResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Get order status
      tags:
      - status
  /orders/{order_id}/upload:
    post:
      consumes:
      - multipart/form-data
      description: Uploads multiple bracketed images to an AutoEnhance AI order. All
        images in a single upload are expected to be bracketed images of the same
        shot.
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      - description: Bracketed images (multiple files allowed)
        in: formData
        name: images
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.UploadResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Upload images to order
      tags:
      - upload
  /orders/{order_id}/verify:
    get:
      consumes:
      - application/json
      description: Checks with AutoEnhance API to verify that an order has uploaded
        brackets/images
      parameters:
      - description: Order ID (UUID)
        in: path
        name: order_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: verification result
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      security:
      - Bearer: []
      summary: Verify order has uploaded images in AutoEnhance
      tags:
      - orders
  /webhooks/autoenhance:
    post:
      consumes:
      - application/json
      description: Receives webhook callbacks from AutoEnhance AI for processing status
        updates. Uses authentication token verification.
      parameters:
      - description: Authentication token (configured in AutoEnhance web app)
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: status
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/instant-hdr-backend_internal_models.ErrorResponse'
      summary: AutoEnhance AI webhook endpoint
      tags:
      - webhooks
securityDefinitions:
  Bearer:
    description: Type "Bearer" followed by a space and JWT token.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
